---
title: vim基础教程
tags: vim
date: 2017-12-29 09:53:34
categories: Linux
---



vim的模式（modal editing）
---

vim拥有4中模式，分别是：

+ **正常模式(normal-mode：navigate the structure of the file)：**

一般打开vim就应该处在这个模式，在任何模式下，按下ESC就返回到正常模式，在对文件的编辑过程中，我们应该更长时间的处在正常模式下。

比如，应该在正常模式下，通过查找或者跳转，找到需要编辑的位置，进入插入模式，修改，退出到正常模式下。如此反复操作。而不应该经常处在插入模式下，通过方向键来回移动 *（vim移动下文会介绍）*。

+ **插入模式(insert-mode: editing the file )：**

也就是所谓的可编辑的模式，在该模式下，可以对文件进行修改。按i/a等都可以进入该模式

+ **可视模式(visual-mode: highlight portions of the file to manipulate at once)：**

可是模式，可以高亮显示选中的文本，从而进行一些批量操作等。ctrl+v选列，shift+v选中行。

+ **命令模式(EX-mode: command mode)：**

命令模式，是用于进行一些其他操作，如保存文本，或者改变vim本身的一些操作。一般按`：`符号进入。

<!-- more -->

-----------------

vim常规的命令表
---

`约定：不做特殊说明，n代表任意一个数字`

*尽量不使用方向键做位置的移动*

| 光标移动命令           | 功能    | 
| ------------- |:-------------:| 
| hjkl          | 上下左右，输入30j可以向下移动30行，其他同理| 
| ctrl+f        | 屏幕向下移动一页      | 
| ctrl+b        | 屏幕向上移动一页      | 
| ctrl+e        | 窗口下移      | 
| ctrl+y        | 窗口上移      | 
| H             | 移动光标到窗口的顶部，相对的      | 
| M             | 移动光标到窗口的中间，相对的      | 
| L             | 移动光标到窗口的底部，相对的      | 
| w             | 移动光标到下一个单词开始处      | 
| e             | 移动光标到下一个单词的结尾处      | 
| 0或者[home]    | 移动光标到这一行的最开始的字符处      | 
| $或者[end]     | 移动光标到这一行的最末尾的字符处      | 
| G             | 移动到这个文件的最后一行，可以使用nG，来跳转到第n行| 
| gg            | 移动到这个文件的第一行，同样可以通过ngg，来跳转到第n行| 
| n[enter]      | 光标向下移动n行，也可以使用:进入命令模式，输入任意一个数字，跳转到任意行| 


| 增删改查命令           | 功能    | 
| ------------- |:-------------:| 
| /word            | 向下寻找一个名词为word的字符串      | 
| ？word            | 向上寻找一个名词为word的字符串      | 
| n            | 此处n指的是字母n按键，重复前一个**查找**的动作      | 
| :n1,n2s/word1/word2/g| 在n1 n2之间寻找workd1这个字符串，并将该字符串替换成word2| 
| :1,$s/word1/word2/g  | 从第一行到最后一行找，替换      | 
| :1,$s/word1/word2/gc | 从提一行到最后一行找，替换，并提示用户      | 
| i，I            | i在光标处插入，I在目前所在行，的第一个非空格符处开始插入      | 
| a, A          | a在光标所在下一个字符处插入，A为光标所在行的最后一个字符处开始插入      | 
| o, O            | o在目前光标的下一行，插入新的一行，O在目前所在行上一行插入一行      | 
| r, R            | r只会替换光标所在的那一个字符一次，R会一直替换直到按下esc（用作修改部分文字）      | 
| x, X            | 在一行字中，x为向后删除一个字符，X为向前删除一个字符      | 
| dd            | 剪切整行，可以4dd 剪切4行      | 
| D            | 从当前位置，一直删除到行尾      | 
| C            | 从当前位置，一直删除到行尾，并进入insert模式   | 
| yy            | 复制整行，同理4yy 向下复制包含光标所在行的4行      | 
| p, P            | 将已经复制的数据，在光标下一行粘贴，P为在光标上一行     | 
| u            | 复原前一个操作     | 
| crtl+r            | 重做前一个操作     | 
| yy            | 屏幕向上移动一页      | 



| 常用的命令模式           | 功能    | 
| ------------- |:-------------:| 
| ：w            | 保存文件的修改     | 
| ：q            | 退出      | 
| ：set nu           | 显示行号      | 
| 常规用法            | ：wq 保存退出，：wq! 强制保存退出 ：w！强制保存， ：q！ 强制退出      | 
| ZZ            | 保存并退出      | 
| ZQ            | 不保存，退出      | 
| ：！            | 执行系统bash命令， 比如 :!ls 查看目录文件，:r !date 读取系统时间并插到下一行   | 

组合命令
---
这部分是极大提升vim使用的一个地方，包含命令，动作 和 文本/对象三部分，分别是：

| commands           | 功能    | 
| ------------- |:-------------:| 
| d            | delete 删除，同样也是剪切     | 
| c            | change 删除，然后在原来的位置进入insert模式     | 
| y            | yank   就是copy复制  | 
| v            | visually select，高亮选中块    | 

| motions           | 功能    | 
| ------------- |:-------------:| 
| a            | all     | 
| i            | in     |
| t            | till     |
| f            | find forward     |
| F            | find backward     |

| text objects           | 功能    | 
| ------------- |:-------------:| 
| w            | words     |
| s            | sentences     |
| p            | paragraphs     |
| t            | tags     |

使用：`{command}{text object or motion}`

例子：

比如caw - change all word， 是修改整个单词，并处在insert模式
    dta - delete till a, 删除字符，直到a这个字符串

-----------------------

宏和标记
---
**宏操作**，相当于把一系列的操作定义成一个方法，然后不断的调用这个方法。
宏的操作是

<pre>
record a macro
q {register}
(do the things)
q
play a macro
@{register}
</pre>

例子：比如要输入100个hello world， 就可以这样操作，按qa（定义一个宏叫做a）- i进入insert模式)-输入hello world - 换行 - esc退出到普通模式-再次按q 宏录制结束。
然后输入100@a， 就会执行100次上面的操作

*ps：注意，在录制的过程中，每一步操作，都会被执行100次（比如单词写错了，删除重写，那么这100次，每次都会先写错，然后删除修改）。*

**标记**，是对正常编程一个很有帮助的功能，这里介绍一些简单用法。

mk 标记一个k，以后每次输入`k就可以跳回到k的位置，有26个字母可以用来标记，同时还有0~9的数字可以用。

使用``可以在两个标记之间切换 

:marks是可以查看所有标记的，标记跳转是可以跳文件的。

-------

其他
----

1.vim下 ctrl+s 锁定，ctrl+q 解锁

2.连续输入10个字符比如hello world 10a hello world  按两下esc

3.*号，向下查找光标处的字符串

4.vim打开文件 
<pre>
vim + 文件 打开，光标到最后一行
vim +3 文件 打开，光标到第3行
vim +/XXX 打开文件，直接定位到第一次出现XXX出现的那一行 （字母n 来回切换）
</pre>
5.vim 批量注释与反注释
<pre>
1.进入可视模式的方法
(1）处理列，将光标移动到想要修改的列（的开始或终止区域），ctrl + v，与行的位置无关，
(2）处理行，将光标移动到想要修改的行（的开始或终止区域），shift + v，与列的位置无关。
 
2.加注（在每一行的开始位置，也即每一列）
将光标移动到第一列，
ctrl + v，进入可视模式
选中全部行的第一列，最好的方式，shift + g 快速移动到最后一行
shift + i，进入 insert 模式
输入 #
两次 esc

3.解注
将光标移动到第一列，
ctrl + v，进入可视模式
选中全部行的第一列，最好的方式，shift + g 快速移动到最后一行
按下d
</pre>
